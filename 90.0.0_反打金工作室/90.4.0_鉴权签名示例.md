## 示例说明

1. 以game`_`id`_`+随机数+时间戳生成源串
2. 以源串和password，以sha256算法生成hash串
3. 转为大写16进制
4. 把源串和hash用"点"连接
5. 用base64编码生成最终的authorization_

## python示例代码

``` python
#!/usr/bin/env python
#coding=utf-8

import sys
import time
import hmac
import hashlib
import base64
import random

def get_auth_str(game_id_, passwd):
    # 以game_id_+随机数+时间戳生成源串
    tmp_rand = random.randint(0,999999999)
    time_stamp = int(time.time())
    original = str(game_id_) + '&' + str(tmp_rand) + '&' + str(time_stamp)
    
    # 以源串和PassWord，以sha256算法生成hash串, 转为大写16进制
    hmac_str = hmac.new(passwd.encode('ascii'), original.encode('ascii'), digestmod=hashlib.sha256).hexdigest().upper()
    
    # 把源串和hash用"点"连接, 用base64编码生成最终的authorization_
    auth_str = base64.b64encode(original + '.' + hmac_str)
    return auth_str

if __name__ == "__main__":
    game_id_ = 12345
    passwd = "your password"
    print get_auth_str(game_id_, passwd)
```

## c++示例代码

```c++
#include "zen_predefine.h"
#include "zen_bytes_hash.h"
#include "zen_bytes_encode.h"
#include "comm_predefine.h"
#include "comm_random_number.h"
#include "algo_hmac.h"

#define UINT_MAX32 0xffffffff

/******************************************************
 * app_id
 * timestamp
 * random
 * sig_method
 * authorization
 * ****************************************************/
int main(int argc, char **argv)
{
    if (argc != 3)
    {
        printf("[appid] [passwd]\n");
        return -1;
    }

    uint32_t appid = (uint32_t)atoi(argv[1]);
    char *passwd = argv[2];
    timeval tv;
    gettimeofday(&tv, NULL);
    uint32_t seed = ((uint64_t)(tv.tv_sec) + (uint64_t)(tv.tv_usec)) % UINT_MAX32;
    uint32_t time_stamp = tv.tv_sec;
    CPetRandom rdm;
    rdm.SetSeed(seed);
    uint32_t random = rdm.Random(UINT_MAX32);
    unsigned char original[1024];
    unsigned char *sha;
    unsigned int out_len;
    unsigned char sha_str[65];
    char sig[1024];
    int ret = snprintf((char *)original, sizeof(original) - 1, "%u&%u&%u", appid, random, time_stamp);

    if (ret < 0)
    {
        printf("snprintf err, ret:%d\n", ret);
        return -1;
    }

    printf("app_id:%u, random:%u, time_stamp:%u, original:%s, len:%d\n", appid, random, time_stamp, original, ret);
    HmacEncode("sha256",
               passwd, strlen(passwd),
               (char *)original, ret,
               sha, out_len);
    // change to str
    hex_to_str(sha, out_len, (char *)sha_str, sizeof(sha_str));
    ret = snprintf(sig, sizeof(sig) - 1, "%s.%s", original, sha_str);

    if (ret < 0)
    {
        printf("snprintf err, ret:%d\n", ret);
        return -1;
    }

    printf("sha_sig:%s\n", sig);
    // encode base64
    unsigned char final_sig[1024];
    size_t final_len;
    ZEN_LIB::base64_encode((unsigned char *)sig, strlen(sig), final_sig, &final_len);
    printf("base64_sig:%s\n", final_sig);
    return 0;
}


```

