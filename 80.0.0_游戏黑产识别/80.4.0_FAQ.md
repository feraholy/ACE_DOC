## 一、服务FAQ

#### 1、黑产恶意等级是如何判定的？

基于腾讯游戏安全中心累积的工作室可疑数据、账号注册画像、自然人/设备/手机号关联机制、ip聚集、ip可疑模型等实时数据评估的，恶意等级越高（数值越大），黑产风险越大。同一个用户，在不同时间点的请求，查询结果可能会不同。

各恶意等级说明如下：

|恶意等级 |说明 |
|-----|-----|
|5 |判定黑产风险极高，应用规则为恶意等级≥5时，准确率约95%，对黑产用户的覆盖率约50% |
|4 |判定黑产风险高，应用规则为恶意等级≥4时，准确率约90%，对黑产用户的覆盖率60% |
|3 |判定黑产风险较高，应用规则为恶意等级≥3时，准确率约80%，对黑产用户的覆盖率80% |
|2 |评估具有一定的黑产风险，不建议针对恶意等级=2的用户进行创角、交易等核心场景的强限制 |
|1 |评估具有轻微的黑产风险，分析恶意等级=1的用户量，可用于协助数据评估，但不建议直接应用于业务场景限制 |
|0 |评估暂无黑产风险或未匹配到可疑数据 |

注：准确率及覆盖率，是基于腾讯内部业务，部分产品数据评估得出。

#### 2、评估黑产风险后，如何应用到具体场景中？

接入服务前，可以通过“号码包评估”功能，快速分析当前运营项目或运营活动中的用户黑产成分，评估接入效果。号码包评估完成后，导出详情结果，结合项目或活动中的用户行为数据（如活跃、付费、留存转化、付费渗透等），制定相对应的使用策略。

#### 3、号码评估功能使用说明

- 务必按照示例文件的格式要求来，不上传的字段内容，不填写即可，无需空格占位符，每个字段之间请使用“|”进行分割；
- 目前暂不支持加密imei的识别，请上传imei明文；
- humanid不可使用明文，请严格按照《》进行处理（注意，加密方式错误，可能会导致识别失效）；
- 手机号或手机号md5（通用MD5加密，字母全小写），二选一传递即可；
- 至少上传一个account_id以外的字段，上传字段越多，越有助于提升识别准确率。

|名称 |类型 |是否必填 |描述 |
|-----|-----| -----|-----|
|device_id |string |否 |手机设备：IMEI/idfa |
|client_ip |string |否 |客户端ip，建议传递 |
|phone_num |string |否 |手机号，与phone_num_md5二选一传递即可 |
|human_id |string |否 |自然人id，通过身份证号等信息hash得出 |
|phone_num_md5 |string |否 |手机号md5，与phone_num二选一传递即可 |
|mac |string |否 |pc设备mac号 |
|account_id |string |否 |账号ID |

## 二、接入FAQ

#### Q：什么是参数鉴权？为什么要进行参数鉴权？如何使用参数鉴权？

A：参数鉴权是利用一种特定的规则生成请求信息，传递给服务端，验证接入方是否拥有某服务请求权限的一种方法。
请求黑产风险识别服务的具体请求生成步骤见《[接入教程](#/doc-center/74424c217313b1ce25318224a217cfac7f05359b)》。

#### Q：如何获取game_key对应的私钥？

A：私钥需要确认已向控制台注册了相应的game_key后才可获得，

#### Q：请求发送失败，可能会是什么原因？

A：首先要确认已注册了game_key，注册后，会提供与game_key一一对应的私钥 PK，
其次确认接入时的鉴权参数或请求公共参数是否发送错误

#### Q：黑产风险识别服务请求中的human_id如何生成？

A：human_id为根据姓名、身份证号生成的哈希值，步骤如下：

    1、对姓名进行 UTF-8 解码，然后进行GBK编码
    2、分别计算姓名和身份证号对应的MD5值，得到作为二进制数据字符串值的摘要name_md5，cert_md5
    3、name_md5，cert_md5对应的MD5值重组
    4、name_md5，cert_md5对应的MD5值二次重组

python代码如下：
```python
# vim set fileencoding=utf-8
"""用户信息哈希"""
import base64
import ctypes
import hashlib
import struct
def hash_name_cert(name, cert_id):
    """根据姓名、身份证号生成哈希值
    :param name string: 姓名，UTF8编码
    :param cert_id string: 身份证号
    :returns: 生成的哈希值
    :rtype: string
    """
    # utf-8 -> gbk
    name = name.decode('utf-8').encode('gbk')
    # 计算MD5
    name_md5 = hashlib.md5(name).digest()
    cert_md5 = hashlib.md5(cert_id).digest()
    # 重组name&cert MD5
    nh, nl = struct.unpack("QQ", name_md5)
    ih, il = struct.unpack("QQ", cert_md5)
    name_cert_hex = base64.b16encode(
        struct.pack("QQ", nh ^ ih, nl ^ il))
    name_cert_md5 = hashlib.md5(name_cert_hex).digest()
    # 二次重组
    nch, ncl = struct.unpack("QQ", name_cert_md5)
    nlv = ctypes.c_uint64(nl+2).value
    name_cert_hex2 = base64.b16encode(
        struct.pack("QQ", nch ^ nh, ncl ^ nlv))
    return name_cert_hex2
```

#### Q：黑产风险识别服务的访问域名？

A：https://service.gamesafe.qq.com/

#### Q：错误码释意

|错误码 |描述 |
|------|-----|
|1002 |鉴权失败，多数情况下为鉴权签名计算错误，请检查计算规则 |
|1367 |查询标签异常，可<a href="https://admin.qidian.qq.com/template/blue/mp/menu/qr-code-jump.html?linkType=0&env=ol&kfuin=2852167644&fid=28&key=d81ab0145faf07ade8b35f63efae4464&cate=1&type=16&ftype=1&_type=wpa&qidian=true" target="_blank">联系客服</a>反馈 |